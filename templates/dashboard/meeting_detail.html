{% extends "base.html" %}

{% block title %}{{ meeting.title|default('Meeting') }} - Mina{% endblock %}

{% block extra_css %}
<style>
.meeting-detail-container {
    min-height: calc(100vh - var(--header-height));
    padding: var(--space-8) 0;
}

.breadcrumb {
    display: inline-flex;
    align-items: center;
    gap: var(--space-2);
    color: var(--color-primary);
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-medium);
    text-decoration: none;
    margin-bottom: var(--space-4);
    transition: gap var(--transition-base);
    animation: fadeInUp 0.6s ease-out;
}

.breadcrumb:hover {
    gap: var(--space-3);
}

.meeting-header {
    margin-bottom: var(--space-8);
    animation: fadeInUp 0.6s ease-out 0.1s;
    animation-fill-mode: both;
}

.meeting-title-main {
    font-size: var(--font-size-4xl);
    font-weight: var(--font-weight-bold);
    background: var(--gradient-primary);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    margin-bottom: var(--space-2);
}

.meeting-meta-info {
    display: flex;
    align-items: center;
    gap: var(--space-4);
    color: var(--color-text-secondary);
    font-size: var(--font-size-base);
    flex-wrap: wrap;
}

.meta-divider {
    width: 4px;
    height: 4px;
    border-radius: 50%;
    background-color: var(--color-text-tertiary);
}

.detail-grid {
    display: grid;
    grid-template-columns: 1fr 320px;
    gap: var(--space-6);
    margin-bottom: var(--space-8);
}

.transcript-card {
    background: var(--glass-bg);
    backdrop-filter: var(--backdrop-blur);
    border: 1px solid var(--glass-border);
    border-radius: var(--radius-2xl);
    padding: var(--space-8);
    margin-bottom: var(--space-6);
    animation: fadeInUp 0.6s ease-out 0.2s;
    animation-fill-mode: both;
    position: relative;
    overflow: hidden;
}

.transcript-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 3px;
    background: var(--gradient-primary);
}

.section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--space-6);
}

.section-title {
    font-size: var(--font-size-xl);
    font-weight: var(--font-weight-semibold);
    color: var(--color-text-primary);
}

.transcript-toolbar {
    display: flex;
    gap: var(--space-2);
}

.transcript-content {
    max-height: 600px;
    overflow-y: auto;
    padding-right: var(--space-2);
}

.transcript-content::-webkit-scrollbar {
    width: 8px;
}

.transcript-content::-webkit-scrollbar-track {
    background: var(--color-surface);
    border-radius: var(--radius-full);
}

.transcript-content::-webkit-scrollbar-thumb {
    background: var(--color-border);
    border-radius: var(--radius-full);
}

.transcript-content::-webkit-scrollbar-thumb:hover {
    background: var(--color-primary);
}

.summary-card {
    background: var(--glass-bg);
    backdrop-filter: var(--backdrop-blur);
    border: 1px solid var(--glass-border);
    border-radius: var(--radius-2xl);
    padding: var(--space-8);
    animation: fadeInUp 0.6s ease-out 0.3s;
    animation-fill-mode: both;
}

.sidebar-card {
    background: var(--glass-bg);
    backdrop-filter: var(--backdrop-blur);
    border: 1px solid var(--glass-border);
    border-radius: var(--radius-xl);
    padding: var(--space-6);
    margin-bottom: var(--space-4);
    animation: fadeInUp 0.6s ease-out;
    animation-fill-mode: both;
}

.sidebar-card:nth-child(1) { animation-delay: 0.2s; }
.sidebar-card:nth-child(2) { animation-delay: 0.3s; }
.sidebar-card:nth-child(3) { animation-delay: 0.4s; }

.card-title {
    font-size: var(--font-size-base);
    font-weight: var(--font-weight-semibold);
    color: var(--color-text-primary);
    margin-bottom: var(--space-4);
}

.task-item {
    display: flex;
    align-items: start;
    gap: var(--space-2);
    padding: var(--space-3);
    border-radius: var(--radius-lg);
    transition: background-color var(--transition-base);
    cursor: pointer;
}

.task-item:hover {
    background-color: var(--color-surface-light);
}

.participant-item {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    padding: var(--space-2);
    border-radius: var(--radius-lg);
    transition: background-color var(--transition-base);
}

.participant-item:hover {
    background-color: var(--color-surface-light);
}

.participant-avatar {
    width: 36px;
    height: 36px;
    border-radius: var(--radius-full);
    background: var(--gradient-primary);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: var(--font-weight-semibold);
    font-size: var(--font-size-sm);
}

.empty-message {
    text-align: center;
    padding: var(--space-8);
    color: var(--color-text-tertiary);
    font-size: var(--font-size-sm);
}

.action-buttons {
    display: flex;
    gap: var(--space-3);
    margin-top: var(--space-4);
    flex-wrap: wrap;
}

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@media (max-width: 1024px) {
    .detail-grid {
        grid-template-columns: 1fr;
    }
    
    .meeting-title-main {
        font-size: var(--font-size-3xl);
    }
}
</style>
{% endblock %}

{% block content %}
<div class="container meeting-detail-container">
    <a href="{{ url_for('dashboard.meetings') }}" class="breadcrumb">
        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
        </svg>
        Back to Meetings
    </a>
    
    <div class="meeting-header">
        <h1 class="meeting-title-main">{{ meeting.title|default('Meeting Details') }}</h1>
        <div class="meeting-meta-info">
            <span>{{ meeting.created_at.strftime('%B %d, %Y at %I:%M %p') if meeting.created_at else 'No date' }}</span>
            {% if meeting.duration %}
            <span class="meta-divider"></span>
            <span>{{ (meeting.duration / 60)|round|int }} minutes</span>
            {% endif %}
            {% if meeting.speaker_count %}
            <span class="meta-divider"></span>
            <span>{{ meeting.speaker_count }} speakers</span>
            {% endif %}
        </div>
    </div>

    <div class="detail-grid">
        <div>
            <div class="transcript-card">
                <div class="section-header">
                    <h2 class="section-title">Transcript</h2>
                    <div class="transcript-toolbar">
                        <button class="btn-icon" title="Search transcript">
                            <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                            </svg>
                        </button>
                        <button class="btn-icon" title="Copy transcript">
                            <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                            </svg>
                        </button>
                        <button class="btn-icon" title="Download transcript">
                            <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"/>
                            </svg>
                        </button>
                    </div>
                </div>
                <div class="transcript-content">
                    {% if meeting.segments and meeting.segments|length > 0 %}
                        {% for segment in meeting.segments %}
                        <div style="margin-bottom: var(--space-4);">
                            <div style="display: flex; align-items: center; gap: var(--space-2); margin-bottom: var(--space-1);">
                                <span style="font-size: var(--font-size-sm); font-weight: var(--font-weight-semibold); color: var(--color-primary);">
                                    {{ segment.speaker_name or segment.speaker_id or 'Speaker' }}
                                </span>
                                <span style="font-size: var(--font-size-xs); color: var(--color-text-tertiary);">
                                    {{ segment.timestamp.strftime('%I:%M %p') if segment.timestamp else '' }}
                                </span>
                            </div>
                            <p style="color: var(--color-text-primary); line-height: var(--line-height-relaxed);">
                                {{ segment.text }}
                            </p>
                        </div>
                        {% endfor %}
                    {% else %}
                        <div class="empty-message">
                            <svg width="48" height="48" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="margin: 0 auto var(--space-4); opacity: 0.5;">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                            </svg>
                            <p>No transcript available</p>
                        </div>
                    {% endif %}
                </div>
            </div>

            {% if meeting.summary %}
            <div class="summary-card">
                <h2 class="section-title" style="margin-bottom: var(--space-4);">Summary</h2>
                <div style="color: var(--color-text-secondary); line-height: var(--line-height-relaxed);">
                    {{ meeting.summary|safe }}
                </div>
            </div>
            {% endif %}
        </div>

        <div>
            <div class="sidebar-card">
                <h3 class="card-title">Action Items</h3>
                {% if meeting.tasks and meeting.tasks|length > 0 %}
                <div style="display: flex; flex-direction: column; gap: var(--space-2);">
                    {% for task in meeting.tasks %}
                    <label class="task-item">
                        <input type="checkbox" {% if task.completed %}checked{% endif %} class="checkbox" style="margin-top: 2px;">
                        <span style="font-size: var(--font-size-sm); color: var(--color-text-primary);">{{ task.description }}</span>
                    </label>
                    {% endfor %}
                </div>
                <div class="action-buttons">
                    <button class="btn btn-secondary btn-sm">Add Task</button>
                </div>
                {% else %}
                <div class="empty-message">
                    <svg width="32" height="32" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="margin: 0 auto var(--space-3); opacity: 0.5;">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/>
                    </svg>
                    <p>No action items</p>
                </div>
                {% endif %}
            </div>

            <div class="sidebar-card">
                <h3 class="card-title">Participants</h3>
                {% if meeting.participants and meeting.participants|length > 0 %}
                <div style="display: flex; flex-direction: column; gap: var(--space-2);">
                    {% for participant in meeting.participants %}
                    <div class="participant-item">
                        <div class="participant-avatar">{{ participant.name[0]|upper }}</div>
                        <span style="font-size: var(--font-size-sm); color: var(--color-text-primary);">{{ participant.name }}</span>
                    </div>
                    {% endfor %}
                </div>
                {% else %}
                <div class="empty-message">
                    <svg width="32" height="32" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="margin: 0 auto var(--space-3); opacity: 0.5;">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
                    </svg>
                    <p>No participants</p>
                </div>
                {% endif %}
            </div>

            <div class="sidebar-card">
                <h3 class="card-title">Actions</h3>
                <div style="display: flex; flex-direction: column; gap: var(--space-2);">
                    <button class="btn btn-secondary btn-sm">
                        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"/>
                        </svg>
                        Share Meeting
                    </button>
                    <button class="btn btn-secondary btn-sm">
                        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"/>
                        </svg>
                        Export
                    </button>
                    <button class="btn btn-secondary btn-sm">
                        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
                        </svg>
                        Edit Details
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
