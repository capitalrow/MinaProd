{% extends "base.html" %}

{% block title %}Preferences - Mina{% endblock %}

{% block extra_css %}
<style>
.settings-container {
    padding: var(--space-8) 0;
    max-width: 1200px;
    min-height: calc(100vh - var(--header-height));
}

.settings-header {
    margin-bottom: var(--space-6);
    animation: fadeInUp 0.6s ease-out;
}

.settings-title {
    font-size: var(--font-size-4xl);
    font-weight: var(--font-weight-bold);
    background: var(--gradient-primary);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    margin-bottom: var(--space-2);
}

.settings-subtitle {
    color: var(--color-text-secondary);
    font-size: var(--font-size-lg);
}

.settings-tabs {
    margin-bottom: var(--space-6);
    border-bottom: 1px solid var(--glass-border);
    animation: fadeIn 0.6s ease-out 0.1s;
    animation-fill-mode: both;
}

.settings-tabs-nav {
    display: flex;
    gap: var(--space-6);
    flex-wrap: wrap;
}

.tab-link {
    padding: var(--space-3) 0;
    color: var(--color-text-secondary);
    font-weight: var(--font-weight-medium);
    transition: all var(--transition-base);
    border-bottom: 2px solid transparent;
    position: relative;
}

.tab-link:hover {
    color: var(--color-text-primary);
}

.tab-link.active {
    color: var(--color-primary);
    border-bottom-color: var(--color-primary);
}

.settings-content {
    max-width: 900px;
}

.settings-card {
    background: var(--glass-bg);
    backdrop-filter: var(--backdrop-blur);
    border: 1px solid var(--glass-border);
    border-radius: var(--radius-xl);
    padding: var(--space-6);
    margin-bottom: var(--space-6);
    animation: fadeInUp 0.6s ease-out;
    animation-fill-mode: both;
    transition: all var(--transition-base);
}

.settings-card:hover {
    border-color: rgba(99, 102, 241, 0.3);
    box-shadow: 0 4px 12px rgba(99, 102, 241, 0.1);
}

.settings-card-title {
    font-size: var(--font-size-xl);
    font-weight: var(--font-weight-semibold);
    margin-bottom: var(--space-4);
    background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-accent) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.form-group {
    display: flex;
    flex-direction: column;
    gap: var(--space-4);
}

.form-checkbox-label {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    cursor: pointer;
    padding: var(--space-3);
    border-radius: var(--radius-lg);
    transition: all var(--transition-base);
}

.form-checkbox-label:hover {
    background: var(--color-surface-hover);
}

.form-checkbox {
    width: 20px;
    height: 20px;
    border-radius: var(--radius-sm);
    border: 2px solid var(--color-border);
    cursor: pointer;
    transition: all var(--transition-base);
    flex-shrink: 0;
}

.form-checkbox:checked {
    background: var(--color-primary);
    border-color: var(--color-primary);
}

.form-checkbox:hover {
    border-color: var(--color-primary);
}

.form-select {
    width: 100%;
    padding: var(--space-3);
    border-radius: var(--radius-lg);
    border: 1px solid var(--color-border);
    background: var(--color-surface);
    color: var(--color-text-primary);
    font-size: var(--font-size-base);
    transition: all var(--transition-base);
}

.form-select:focus {
    outline: none;
    border-color: var(--color-primary);
    box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
}

.form-select:hover {
    border-color: var(--color-primary);
}

.form-label {
    display: block;
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-medium);
    margin-bottom: var(--space-2);
    color: var(--color-text-primary);
}

.form-help {
    font-size: var(--font-size-xs);
    color: var(--color-text-tertiary);
    margin-top: var(--space-1);
}

.checkbox-content {
    flex: 1;
}

.checkbox-title {
    font-weight: var(--font-weight-medium);
    margin-bottom: var(--space-1);
}

.checkbox-description {
    font-size: var(--font-size-sm);
    color: var(--color-text-secondary);
}

/* Stagger animations for cards */
.settings-card:nth-child(1) { animation-delay: 0.2s; }
.settings-card:nth-child(2) { animation-delay: 0.25s; }
.settings-card:nth-child(3) { animation-delay: 0.3s; }
.settings-card:nth-child(4) { animation-delay: 0.35s; }
.settings-card:nth-child(5) { animation-delay: 0.4s; }

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes fadeIn {
    from {
        opacity: 0;
    }
    to {
        opacity: 1;
    }
}

@media (max-width: 768px) {
    .settings-title {
        font-size: var(--font-size-3xl);
    }
    
    .settings-tabs-nav {
        gap: var(--space-4);
    }
    
    .form-checkbox-label {
        flex-direction: column;
        align-items: flex-start;
    }
}
</style>
{% endblock %}

{% block content %}
<div class="container settings-container">
    <!-- Header -->
    <div class="settings-header">
        <h1 class="settings-title">Settings</h1>
        <p class="settings-subtitle">Manage your account and preferences</p>
    </div>

    <!-- Tabs -->
    <div class="settings-tabs">
        <nav class="settings-tabs-nav">
            <a href="{{ url_for('settings.preferences') }}" class="tab-link active">Preferences</a>
            <a href="{{ url_for('settings.integrations') }}" class="tab-link">Integrations</a>
            <a href="{{ url_for('settings.profile') }}" class="tab-link">Profile</a>
            <a href="{{ url_for('settings.workspace_management') }}" class="tab-link">Workspace</a>
        </nav>
    </div>

    <div class="settings-content">
        <!-- Notification Settings -->
        <div class="settings-card">
            <h2 class="settings-card-title">Notification Settings</h2>
            <form method="POST" action="{{ url_for('settings.update_preferences') }}">
                <div class="form-group">
                    <label class="form-checkbox-label">
                        <input type="checkbox" name="email_notifications" checked class="form-checkbox">
                        <div class="checkbox-content">
                            <p class="checkbox-title">Email Notifications</p>
                            <p class="checkbox-description">Receive email updates about your meetings</p>
                        </div>
                    </label>
                    
                    <label class="form-checkbox-label">
                        <input type="checkbox" name="meeting_reminders" checked class="form-checkbox">
                        <div class="checkbox-content">
                            <p class="checkbox-title">Meeting Reminders</p>
                            <p class="checkbox-description">Get reminders before scheduled meetings</p>
                        </div>
                    </label>
                    
                    <label class="form-checkbox-label">
                        <input type="checkbox" name="task_updates" checked class="form-checkbox">
                        <div class="checkbox-content">
                            <p class="checkbox-title">Task Updates</p>
                            <p class="checkbox-description">Notifications when tasks are updated</p>
                        </div>
                    </label>

                    <label class="form-checkbox-label">
                        <input type="checkbox" name="insight_notifications" checked class="form-checkbox">
                        <div class="checkbox-content">
                            <p class="checkbox-title">AI Insights Ready</p>
                            <p class="checkbox-description">Notify when meeting summaries and action items are generated</p>
                        </div>
                    </label>
                </div>
                
                <div style="margin-top: var(--space-6);">
                    <button type="submit" class="btn btn-primary">Save Preferences</button>
                </div>
            </form>
        </div>

        <!-- Transcription Controls -->
        <div class="settings-card">
            <h2 class="settings-card-title">Transcription Controls</h2>
            <form method="POST" action="{{ url_for('settings.update_preferences') }}">
                <div class="form-group">
                    <div>
                        <label class="form-label">Default Language</label>
                        <select name="default_language" class="form-select">
                            <option value="en" selected>English</option>
                            <option value="es">Spanish</option>
                            <option value="fr">French</option>
                            <option value="de">German</option>
                            <option value="zh">Chinese</option>
                            <option value="ja">Japanese</option>
                            <option value="pt">Portuguese</option>
                        </select>
                    </div>

                    <div>
                        <label class="form-label">Transcription Mode</label>
                        <select name="transcription_mode" class="form-select">
                            <option value="realtime" selected>Real-time (faster, less accurate)</option>
                            <option value="accurate">Post-processed (slower, more accurate)</option>
                            <option value="hybrid">Hybrid (real-time + refinement)</option>
                        </select>
                    </div>
                    
                    <label class="form-checkbox-label">
                        <input type="checkbox" name="speaker_diarization" checked class="form-checkbox">
                        <div class="checkbox-content">
                            <p class="checkbox-title">Speaker Diarization</p>
                            <p class="checkbox-description">Automatically detect and label different speakers</p>
                        </div>
                    </label>

                    <label class="form-checkbox-label">
                        <input type="checkbox" name="profanity_filter" class="form-checkbox">
                        <div class="checkbox-content">
                            <p class="checkbox-title">Profanity Filter</p>
                            <p class="checkbox-description">Automatically filter profane language in transcripts</p>
                        </div>
                    </label>

                    <label class="form-checkbox-label">
                        <input type="checkbox" name="auto_punctuation" checked class="form-checkbox">
                        <div class="checkbox-content">
                            <p class="checkbox-title">Auto Punctuation</p>
                            <p class="checkbox-description">Automatically add punctuation and capitalization</p>
                        </div>
                    </label>
                </div>
                <div style="margin-top: var(--space-6);">
                    <button type="submit" class="btn btn-primary">Save Transcription Settings</button>
                </div>
            </form>
        </div>

        <!-- Privacy & Compliance -->
        <div class="settings-card">
            <h2 class="settings-card-title">Privacy & Compliance</h2>
            <form method="POST" action="{{ url_for('settings.update_preferences') }}">
                <div class="form-group">
                    <div>
                        <label class="form-label">Data Retention Period</label>
                        <select name="data_retention" class="form-select">
                            <option value="30">30 days</option>
                            <option value="90" selected>90 days</option>
                            <option value="365">1 year</option>
                            <option value="forever">Forever</option>
                        </select>
                        <p class="form-help">Recordings and transcripts will be automatically deleted after this period</p>
                    </div>

                    <div>
                        <label class="form-label">Recording Consent</label>
                        <select name="recording_consent" class="form-select">
                            <option value="always">Always ask for consent</option>
                            <option value="auto" selected>Auto-consent (default on)</option>
                            <option value="custom">Custom consent message</option>
                        </select>
                    </div>

                    <label class="form-checkbox-label">
                        <input type="checkbox" name="auto_redaction" class="form-checkbox">
                        <div class="checkbox-content">
                            <p class="checkbox-title">Auto-redact PII</p>
                            <p class="checkbox-description">Automatically mask emails, phone numbers, and credit card numbers</p>
                        </div>
                    </label>

                    <div>
                        <label class="form-label">Default Meeting Access</label>
                        <select name="meeting_access" class="form-select">
                            <option value="workspace" selected>Workspace only</option>
                            <option value="team">Specific teams</option>
                            <option value="private">Private (only me)</option>
                            <option value="public">Public link</option>
                        </select>
                    </div>
                </div>
                <div style="margin-top: var(--space-6);">
                    <button type="submit" class="btn btn-primary">Save Privacy Settings</button>
                </div>
            </form>
        </div>

        <!-- AI Insights Configuration -->
        <div class="settings-card">
            <h2 class="settings-card-title">AI Insights Configuration</h2>
            <form method="POST" action="{{ url_for('settings.update_preferences') }}">
                <div class="form-group">
                    <div>
                        <label class="form-label">Auto-generate Summaries</label>
                        <select name="auto_summary" class="form-select">
                            <option value="immediate" selected>Immediately after meeting</option>
                            <option value="hourly">Within 1 hour</option>
                            <option value="daily">Daily batch</option>
                            <option value="manual">Manual only</option>
                        </select>
                    </div>

                    <div>
                        <label class="form-label">Action Item Detection</label>
                        <select name="action_detection" class="form-select">
                            <option value="low">Low sensitivity (fewer items)</option>
                            <option value="medium" selected>Medium sensitivity</option>
                            <option value="high">High sensitivity (more items)</option>
                        </select>
                    </div>

                    <label class="form-checkbox-label">
                        <input type="checkbox" name="auto_detect_decisions" checked class="form-checkbox">
                        <div class="checkbox-content">
                            <p class="checkbox-title">Auto-detect Decisions</p>
                            <p class="checkbox-description">Identify and highlight key decisions made during meetings</p>
                        </div>
                    </label>

                    <label class="form-checkbox-label">
                        <input type="checkbox" name="sentiment_analysis" class="form-checkbox">
                        <div class="checkbox-content">
                            <p class="checkbox-title">Sentiment Analysis</p>
                            <p class="checkbox-description">Analyze emotional tone and engagement levels</p>
                        </div>
                    </label>

                    <label class="form-checkbox-label">
                        <input type="checkbox" name="auto_create_tasks" class="form-checkbox">
                        <div class="checkbox-content">
                            <p class="checkbox-title">Auto-create Tasks</p>
                            <p class="checkbox-description">Automatically create tasks from detected action items</p>
                        </div>
                    </label>
                </div>
                <div style="margin-top: var(--space-6);">
                    <button type="submit" class="btn btn-primary">Save AI Settings</button>
                </div>
            </form>
        </div>

        <!-- Audio & Recording -->
        <div class="settings-card">
            <h2 class="settings-card-title">Audio & Recording</h2>
            <form method="POST" action="{{ url_for('settings.update_preferences') }}">
                <div class="form-group">
                    <div>
                        <label class="form-label">Audio Quality</label>
                        <select name="audio_quality" class="form-select">
                            <option value="high">High Quality (48kHz)</option>
                            <option value="standard" selected>Standard (44.1kHz)</option>
                            <option value="low">Low Bandwidth (22kHz)</option>
                        </select>
                    </div>

                    <div>
                        <label class="form-label">Noise Cancellation</label>
                        <select name="noise_cancellation" class="form-select">
                            <option value="aggressive">Aggressive (remove all background noise)</option>
                            <option value="moderate" selected>Moderate (balanced)</option>
                            <option value="off">Off (preserve original audio)</option>
                        </select>
                    </div>
                    
                    <label class="form-checkbox-label">
                        <input type="checkbox" name="auto_save" checked class="form-checkbox">
                        <div class="checkbox-content">
                            <p class="checkbox-title">Auto-save recordings</p>
                            <p class="checkbox-description">Automatically save recordings to cloud storage</p>
                        </div>
                    </label>

                    <label class="form-checkbox-label">
                        <input type="checkbox" name="auto_start_recording" class="form-checkbox">
                        <div class="checkbox-content">
                            <p class="checkbox-title">Auto-start Recording</p>
                            <p class="checkbox-description">Automatically start recording when you join a meeting</p>
                        </div>
                    </label>
                </div>
                <div style="margin-top: var(--space-6);">
                    <button type="submit" class="btn btn-primary">Save Audio Settings</button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}
