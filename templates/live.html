{% extends "base_clean.html" %}

{% block title %}Live Transcription - Mina{% endblock %}

{% block head %}
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
<link href="/static/css/professional_ui.css" rel="stylesheet">
{% endblock %}

{% block content %}
<div class="app-container">
    <!-- Header -->
    <header class="app-header">
        <div class="header-content">
            <h1 class="app-title">
                <i class="fas fa-microphone-alt"></i>
                Live Transcription
            </h1>
            <div class="connection-status">
                <span class="status-dot ready" id="statusDot"></span>
                <span class="status-text" id="statusText">Ready</span>
            </div>
        </div>
    </header>

    <!-- Main Content Grid -->
    <div class="main-grid">
        
        <!-- Control Panel -->
        <aside class="control-panel">
            <div class="panel-section">
                <h3 class="section-title">Recording</h3>
                
                <div class="record-controls">
                    <button class="record-btn" id="recordButton">
                        <i class="fas fa-microphone"></i>
                    </button>
                    
                    <div class="control-buttons">
                        <button class="btn btn-secondary" id="pauseButton" disabled>
                            <i class="fas fa-pause"></i>
                        </button>
                        <button class="btn btn-outline" id="stopButton" disabled>
                            <i class="fas fa-stop"></i>
                        </button>
                    </div>
                </div>

                <div class="audio-meter">
                    <label class="meter-label">Audio Level</label>
                    <div class="level-bar">
                        <div class="level-fill" id="audioLevel"></div>
                    </div>
                </div>
            </div>

            <div class="panel-section">
                <h3 class="section-title">Session Stats</h3>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="sessionTime">00:00</div>
                        <div class="stat-label">Duration</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-value" id="wordCount">0</div>
                        <div class="stat-label">Words</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-value" id="confidenceScore">0%</div>
                        <div class="stat-label">Accuracy</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-value" id="chunksProcessed">0</div>
                        <div class="stat-label">Chunks</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-value" id="latencyMs">0ms</div>
                        <div class="stat-label">Latency</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-value" id="qualityScore">0%</div>
                        <div class="stat-label">Quality</div>
                    </div>
                </div>
            </div>
            
            <!-- ðŸŽ¯ NEW: System Health Panel -->
            <div class="panel-section">
                <h3 class="section-title">
                    <i class="fas fa-heartbeat"></i>
                    System Health
                </h3>
                
                <div class="health-indicators">
                    <div class="health-item">
                        <span class="health-label">Audio Processing</span>
                        <span class="health-status" id="audioProcessingHealth">
                            <i class="fas fa-circle text-success"></i> Ready
                        </span>
                    </div>
                    
                    <div class="health-item">
                        <span class="health-label">WebM Conversion</span>
                        <span class="health-status" id="conversionHealth">
                            <i class="fas fa-circle text-warning"></i> Checking
                        </span>
                    </div>
                    
                    <div class="health-item">
                        <span class="health-label">Whisper API</span>
                        <span class="health-status" id="whisperHealth">
                            <i class="fas fa-circle text-success"></i> Connected
                        </span>
                    </div>
                    
                    <div class="health-item">
                        <span class="health-label">Network</span>
                        <span class="health-status" id="networkHealth">
                            <i class="fas fa-circle text-success"></i> Stable
                        </span>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Transcript Area -->
        <main class="transcript-area">
            <div class="transcript-header">
                <h3 class="transcript-title">
                    <i class="fas fa-file-alt"></i>
                    Live Transcript
                    <span class="transcript-mode" id="transcriptMode">Real-time</span>
                </h3>
                
                <div class="transcript-actions">
                    <!-- ðŸŽ¯ NEW: Quality Indicator -->
                    <div class="quality-indicator" id="qualityIndicator">
                        <span class="quality-label">Quality:</span>
                        <span class="quality-badge" id="qualityBadge">Excellent</span>
                    </div>
                    
                    <button class="btn btn-icon" id="pauseTranscript" title="Pause/Resume" aria-label="Pause or resume transcription">
                        <i class="fas fa-pause"></i>
                    </button>
                    <button class="btn btn-icon" id="clearTranscript" title="Clear" aria-label="Clear transcript">
                        <i class="fas fa-trash"></i>
                    </button>
                    <button class="btn btn-icon" id="copyTranscript" title="Copy" aria-label="Copy transcript to clipboard">
                        <i class="fas fa-copy"></i>
                    </button>
                    <button class="btn btn-icon" id="downloadTranscript" title="Download" aria-label="Download transcript as text file">
                        <i class="fas fa-download"></i>
                    </button>
                    <!-- ðŸŽ¯ NEW: Settings -->
                    <button class="btn btn-icon" id="transcriptSettings" title="Settings" aria-label="Transcription settings">
                        <i class="fas fa-cog"></i>
                    </button>
                </div>
            </div>

            <div class="transcript-content" id="transcriptContainer" role="log" aria-live="polite" aria-label="Live transcription text">
                <div class="transcript-empty">
                    <i class="fas fa-microphone-slash"></i>
                    <p>Click record to start transcription</p>
                    <div class="getting-started">
                        <h4>Getting Started:</h4>
                        <ol>
                            <li>Ensure microphone access is allowed</li>
                            <li>Speak clearly and at normal volume</li>
                            <li>Click the record button to begin</li>
                            <li>View real-time transcription below</li>
                        </ol>
                    </div>
                </div>
            </div>
            
            <!-- ðŸŽ¯ NEW: Advanced Controls -->
            <div class="transcript-controls" id="transcriptControls" style="display: none;">
                <div class="control-row">
                    <label class="control-label">
                        <input type="checkbox" id="autoScroll" checked> Auto-scroll
                    </label>
                    <label class="control-label">
                        <input type="checkbox" id="timestampMode"> Show timestamps
                    </label>
                    <label class="control-label">
                        <input type="checkbox" id="confidenceMode"> Show confidence
                    </label>
                    <label class="control-label">
                        <input type="range" id="fontSizeSlider" min="12" max="24" value="16">
                        <span>Font Size: <span id="fontSizeValue">16px</span></span>
                    </label>
                </div>
            </div>

            <!-- ðŸŽ¯ ENHANCED: Multi-metric Performance Panel -->
            <div class="performance-panel">
                <div class="metric-row">
                    <div class="metric-item">
                        <div class="metric-label">
                            <i class="fas fa-bullseye"></i> Confidence
                        </div>
                        <div class="metric-value">
                            <span id="confidenceText">0%</span>
                            <div class="metric-bar">
                                <div class="metric-fill" id="confidenceFill"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="metric-item">
                        <div class="metric-label">
                            <i class="fas fa-tachometer-alt"></i> Latency
                        </div>
                        <div class="metric-value">
                            <span id="latencyText">0ms</span>
                            <div class="metric-bar">
                                <div class="metric-fill" id="latencyFill"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="metric-item">
                        <div class="metric-label">
                            <i class="fas fa-chart-line"></i> Quality
                        </div>
                        <div class="metric-value">
                            <span id="qualityText">0%</span>
                            <div class="metric-bar">
                                <div class="metric-fill" id="qualityFill"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- ðŸŽ¯ NEW: Real-time Diagnostics -->
                <div class="diagnostics-row" id="diagnosticsRow" style="display: none;">
                    <div class="diagnostic-item">
                        <span class="diagnostic-label">Processing Method:</span>
                        <span class="diagnostic-value" id="processingMethod">Unknown</span>
                    </div>
                    <div class="diagnostic-item">
                        <span class="diagnostic-label">Audio Format:</span>
                        <span class="diagnostic-value" id="audioFormat">Unknown</span>
                    </div>
                    <div class="diagnostic-item">
                        <span class="diagnostic-label">Chunk Size:</span>
                        <span class="diagnostic-value" id="chunkSize">0 KB</span>
                    </div>
                </div>
                
                <button class="diagnostics-toggle" id="diagnosticsToggle">
                    <i class="fas fa-chart-bar"></i> Show Diagnostics
                </button>
            </div>
        </main>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="/static/js/ai_enhancements.js"></script>
<script src="/static/js/advanced_speech_engine.js"></script>
<script src="/static/js/fixed_transcription.js"></script>
<script>
// Initialize REVOLUTIONARY NEXT-GENERATION system
document.addEventListener('DOMContentLoaded', function() {
    console.log('ðŸŽ† Loading Next-Generation Mina Transcription System v3.0...');
    console.log('ðŸ§  AI Components: âœ… Smart Punctuation, âœ… Contextual Memory, âœ… Adaptive Quality');
    console.log('ðŸŽ† Revolutionary Features: âœ… Advanced Speech Engine, âœ… Real-time Analysis, âœ… Intelligent Buffering');
    console.log('âš¡ Performance: âœ… Multi-threaded Processing, âœ… Dynamic Optimization, âœ… Continuity Engine');
    console.log('ðŸš€ System Status: Next-generation AI transcription ready');
    // The revolutionary system auto-initializes with breakthrough capabilities
});
</script>
{% endblock %}
