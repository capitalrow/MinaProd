# Mina Backup Retention Configuration
# Controls backup retention policies across different storage tiers

# =============================================
# Retention Tiers
# =============================================

# Tier 1: Hot Storage (Local Encrypted)
# - Location: ~/.mina_backups_encrypted/
# - Retention: 30 days
# - Purpose: Fast recovery, recent backups
# - Cost: Low (local storage)
RETENTION_HOT_DAYS=30

# Tier 2: Warm Storage (Cloud Standard)
# - Location: S3 Standard-IA or GCS Nearline
# - Retention: 90 days
# - Purpose: Compliance, historical recovery
# - Cost: Medium
RETENTION_WARM_DAYS=90

# Tier 3: Cold Storage (Cloud Archive)
# - Location: S3 Glacier or GCS Coldline
# - Retention: 365 days (optional)
# - Purpose: Long-term compliance
# - Cost: Low
RETENTION_COLD_DAYS=365

# =============================================
# Cloud Storage Configuration
# =============================================

# Cloud Provider: s3 or gcs
CLOUD_BACKUP_PROVIDER="s3"

# AWS S3 Configuration
S3_BACKUP_BUCKET="mina-backups"  # Used when --bucket not specified
S3_BACKUP_BUCKET_30DAY="mina-backups-30day"  # Dedicated 30-day bucket
S3_BACKUP_BUCKET_90DAY="mina-backups-90day"  # Dedicated 90-day bucket
S3_BACKUP_REGION="us-east-1"

# GCS Configuration (alternative)
GCS_BACKUP_BUCKET="mina-backups"  # Used when --bucket not specified
GCS_BACKUP_BUCKET_30DAY="mina-backups-30day"
GCS_BACKUP_BUCKET_90DAY="mina-backups-90day"
GCS_BACKUP_PROJECT="mina-project"

# =============================================
# Encryption Configuration
# =============================================

# Force encryption for all backups (recommended: true for production)
REQUIRE_ENCRYPTION=true

# GPG encryption strength
GPG_CIPHER_ALGO="AES256"

# =============================================
# Backup Schedule
# =============================================

# Local backup frequency
BACKUP_SCHEDULE="daily"  # daily, hourly, or cron expression
BACKUP_HOUR=2  # For daily backups (2 AM)

# Cloud sync frequency
CLOUD_SYNC_SCHEDULE="daily"  # After local backup completes
CLOUD_SYNC_HOUR=3  # 1 hour after backup (3 AM)

# =============================================
# Monitoring & Alerting
# =============================================

# Alert if backup fails N consecutive times
BACKUP_FAILURE_THRESHOLD=2

# Alert if backup age exceeds N hours (for daily schedule)
BACKUP_MAX_AGE_HOURS=25

# Alert if backup size drops more than N percent
BACKUP_SIZE_DROP_THRESHOLD=50

# =============================================
# Compliance
# =============================================

# Enable backup audit logging
ENABLE_AUDIT_LOG=true
AUDIT_LOG_PATH="/var/log/mina/backup_audit.log"

# Enable backup verification
ENABLE_BACKUP_VERIFICATION=true

# Backup testing frequency (days)
BACKUP_TEST_FREQUENCY=7

# =============================================
# Advanced Settings
# =============================================

# Parallel uploads to cloud (improves sync speed)
CLOUD_SYNC_PARALLEL=true

# Compression level (1-9, higher = better compression but slower)
COMPRESSION_LEVEL=9

# Maximum backup file size (MB) before splitting
MAX_BACKUP_SIZE_MB=1000

# Backup file naming pattern
BACKUP_NAME_PATTERN="mina_db_backup_%Y%m%d_%H%M%S"

# =============================================
# Usage
# =============================================
#
# Load this configuration in scripts:
#   source config/backup_retention.conf
#
# Override for specific runs:
#   RETENTION_HOT_DAYS=7 ./scripts/backup_database.sh
#
# =============================================
